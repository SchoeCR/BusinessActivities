@page "/enquiry"
@rendermode InteractiveServer
@inject ILogger<Enquiry> Logger

<PageTitle>Enquiry</PageTitle>

<h3 class="fw-bold">Enquiry</h3>

<EditForm Model="Model" OnSubmit="Submit" FormName="NewEnquiry">
    <div style="display:flex; gap:3rem; flex-wrap:wrap;">
        <!-- Left column -->
        <div style="flex:0.5; min-width:300px;">
            <div class="mb-3">
                <label for="enquiryDate" class="form-label fw-bold">Date:</label>
                <DateInput Id="enquiryDate" @bind-Value="Model!.enquiryDate" Max="@today" Placeholder="Please enter date of enquiry" />
            </div>
            <div class="mb-3">
                <label for="enquiryMethod" class="form-label fw-bold">Method:</label>
                <InputSelect id="enquiryMethod" class="form-select" @bind-Value="Model!.enquiryMethod">
                    <option value="">Select Method</option>
                    <option value="Phone">Phone</option>
                    <option value="Email">Email</option>
                    <option value="Walk-in">Walk-in</option>
                    <option value="Other">Other</option>
                </InputSelect>
            </div>
            <div class="mb-3">
                <label for="customerID" class="form-label fw-bold">Customer:</label>
                <InputSelect id="customerID" class="form-select" @bind-Value="Model!.customerID">
                    <option value="">Select Customer</option>
                    <option value="CUST001">CUST001 - Acme Corp</option>
                    <option value="CUST002">CUST002 - Globex Inc</option>
                    <option value="CUST003">CUST003 - Soylent Co</option>
                    <option value="CUST004">CUST004 - Initech</option>
                </InputSelect>
            </div>
        </div>
        <div style="flex:1; min-width:300px;">
            <div class="mb-3">
                <label for="enquiryDiscipline" class="form-label fw-bold">Discipline:</label>
                <InputSelect id="enquiryDiscipline" class="form-select" @bind-Value="Model!.enquiryDiscipline">
                    <option value="">Select Discipline</option>
                    <option value="Fire">Fire</option>
                    <option value="Acoustics">Acoustics</option>
                    <option value="Smoke">Smoke</option>
                    <option value="Assessment-Fire">Assessment-Fire</option>
                    <option value="Assessment-Smoke">Assessment-Smoke</option>
                    <option value="Other">Other</option>
                </InputSelect>
            </div>
            <div class="mb-3">
                <label for="enquiryStandard" class="form-label fw-bold">Method/Standard:</label>
                <div style="display:flex; gap:1rem;">
                    <div style="flex:1;">
                        <TextInput Id="enquiryStandard" class="form-control" @bind-Value="Model!.enquiryStandard" Placeholder="Enter enquiry method/standard" />
                    </div>
                    <div style="flex:1;">
                        <TextInput Id="enquiryAusEquivalent" class="form-control" @bind-Value="Model!.enquiryAusEquivalent" Placeholder="Enter Australian equivalent standard" />
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label for="enquiryRevenue" class="form-label fw-bold">Estimated Revenue (AUD):</label>                
                <CurrencyInput Id="enquiryRevenue" Class="form-control" @bind-Value="Model!.enquiryRevenue" Placeholder="Enter estimated revenue (AUD)" />
            </div>
            <div class="mb-3">
                <label for="enquiryMessage" class="form-label fw-bold">Message:</label>
                <TextAreaInput id="enquiryMessage" class="form-control" @bind-Value="Model!.enquiryMessage" Placeholder="Enter message" style="min-height:250px;" />
            </div>
        </div>
    </div>
    <div>
        <button type="submit">Submit</button>
    </div>
</EditForm>

@code {
    [SupplyParameterFromForm]
    private EnquiryDto? Model { get; set; }

    protected override void OnInitialized() => Model ??= new();

    private void Submit()
    {
        Model!.enquiryId = Guid.NewGuid().ToString();
        Logger.LogInformation("Id = {Id}", Model?.enquiryId);
    }

    public class EnquiryDto
    {
        public string? enquiryId { get; set; }
        public DateOnly? enquiryDate { get; set; } = DateOnly.FromDateTime(DateTime.Now);
        public string? enquiryDiscipline { get; set; }
        public string? enquiryMethod { get; set; }
        public string? enquiryStandard { get; set; }
        public string? enquiryAusEquivalent { get; set; }
        public int? enquiryRevenue { get; set; }
        public string? enquiryMessage { get; set; }
        public string? customerID { get; set; }
        public string? enquiryStatus { get; set; }
        public string? enquiryOutcome { get; set; }
        public string? enquiryComments { get; set; }

    }
    DateOnly today = DateOnly.FromDateTime(DateTime.Now);
}
